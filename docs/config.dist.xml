<!-- The application element that contains all other elements. -->
<DistrictBuilder>

    <!-- Define legislative bodies referenced in the system. -->
    <LegislativeBodies>
        <!-- A Legislative body has an ID (for referencing in GeoLevel
            definitions later), a name, and a label for plan items 
            ("District" for Congressional, etc) -->
        <LegislativeBody id="congress" name="Congressional" member="District %s" maxdistricts="11"/>
        <LegislativeBody id="house" name="State House" member="District %s" maxdistricts="100" />
        <LegislativeBody id="senate" name="State Senate" member="District %s" maxdistricts="40" />
    </LegislativeBodies>

    <!-- A list of subjects referenced in the system. -->
    <Subjects>
        <!-- A Subject is a measurement type, such as "Total Population". 
            The subject is mapped to an attribute during the import phase,
            and contains a long and short display name. Subjects have IDs
            for referencing in GeoLevel definitions later. -->
        <Subject id="poptot" field="TOTPOP" name="Total Population" 
                 short_name="Total Pop." displayed="true" sortkey="1" />
        <Subject id="popblk" field="TOTPOP_B" name="African-American" 
                 short_name="Black" displayed="false" sortkey="2" />
        <Subject id="pophisp" field="TOTPOP_H" name="Hispanic or Latino"
                 short_name="Hispanic" displayed="false" sortkey="3" />
        <Subject id="popwnh" field="TOTPOP_WNH" name="Total White Non-Hispanic" 
                 short_name="White" displayed="false" sortkey="4" />
        <Subject id="popasn" field="TOTPOP_A" name="Asian-American"
                 short_name="As Amer" displayed="false" sortkey="5" />
        <Subject id="popnam" field="TOTPOP_NA" name="Native American"
                 short_name="Nat Amer" displayed="false" sortkey="6" />
        <Subject id="poppild" field="TOTPOP_PI" name="Pacific Islander"
                 short_name="Pac Isldr" displayed="false" sortkey="7" />
        <Subject id="vap" field="VAP" name="Voting Age Population"
                 short_name="Voters" displayed="false" sortkey="8" />
        <Subject id="vapwnh" field="VAP_WNH" name="Voting Age Population - White"
                 short_name="Wht Votng Age" displayed="false" sortkey="9" />
        <Subject id="vapblk" field="VAP_B" name="Voting Age Population - African-American"
                 short_name="Blk Votng Age" displayed="false" sortkey="10" />
        <Subject id="vaphisp" field="VAP_H" name="Voting Age Population - Hispanic/Latino"
                 short_name="Hsp Votng Age" displayed="false" sortkey="11" />
        <Subject id="vapasn" field="VAP_A" name="Voting Age Population - Asian-American"
                 short_name="As Am Votng Age" displayed="false" sortkey="12" />
        <Subject id="vapnam" field="VAP_NA" name="Voting Age Population - Native American"
                 short_name="Nat Amer Votng Age" displayed="false" sortkey="13" />
        <Subject id="vappild" field="VAP_PI" name="Voting Age Population - Pacific Islander"
                 short_name="Pac Isldr Votng Age" displayed="false" sortkey="14" />
        <Subject id="presdem" field="PRS08DEM" name="Democratic Voters"
                 short_name="Democrat 08" displayed="false" sortkey="15" />
        <Subject id="presrep" field="PRS08REP" name="Republican Voters"
                 short_name="Republican 08" displayed="false" sortkey="16" />
        <Subject id="presoth" field="PRS08OTH" name="Other Voters"
                 short_name="Other 08" displayed="false" sortkey="17" />
        <Subject id="govdem" field="GOV09DEM" name="Democratic Voters, Governor '09"
                 short_name="Democrat 09" displayed="false" sortkey="18" />
        <Subject id="govrep" field="GOV09REP" name="Republican Voters, Governor '09"
                 short_name="Republican 09" displayed="false" sortkey="19" />
        <Subject id="govoth" field="GOV09OTH" name="Sum All Other Candidates, Governor '09"
                 short_name="Other Cand 09" displayed="false" sortkey="20" />
        <Subject id="govtot" field="GOV09TOT" name="Total Voters, Governor '09"
                 short_name="All Voters 09" displayed="false" sortkey="21" />
 
        <!-- You can alias a subject by overriding the field, if the
            import shapefiles have different field names at different
            geographic levels. -->
        <!-- <Subject id="pophisp1" field="POPHISP" aliasfor="pophisp"/> -->
    </Subjects>

    <Targets>
        <!-- A target is an objective measure of a district for a legislative
            district. Each discrete target (usually 1 per legislative body/subject
            combination) must be listed here, with a unique ID.
        -->
        <Target id="tottarget" subjectref="poptot" value="727366" range1="0.005" range2="0.01" />
        <Target id="housetarget" subjectref="poptot" value="80010" range1="0.05" range2="0.10" />
        <Target id="senatetarget" subjectref="poptot" value="200026" range1="0.05" range2="0.10" />
    </Targets>
   
    <Scoring>
        <!--
        Configuration items relating to the scoring and evaluation
        of plans created by users.
        -->
        <ScoreFunctions>
            <!-- 
            Each ScoreFunction configuration item describes how a scoring
            calculator should be used to generate a score of a district or
            plan, based on either 1) a subject, 2) a score, or 3) a literal
            value.
            -->
            <ScoreFunction id="plan_equivalence" type="plan" label="Equal Population" 
                calculator="publicmapping.redistricting.calculators.Equivalence"
                description="The Equipopulation score is the difference between the district with the highest population and the district with the lowest population.">
                <!--
                This score function is a plan-type score function,
                which means that it will generate one score per plan.
                The score calculator is the python class in the 'calculator'
                attribute.
                The parameters passed to the calculator are passed by
                key=value pair, based on the 'name' of the argument. The 
                value of an argument may be:
                  * A computed characteristic if the argument element is a
                    SubjectArgument.
                  * A literal value if the element is an Argument element 
                    and the 'value' attribute is not empty.
                  * A computed score result if the argument element is a 
                    ScoreArgument.
                -->
                <SubjectArgument name="value" ref="poptot" />
            </ScoreFunction>

            <ScoreFunction id="plan_schwartzberg" type="plan" label="Average Compactness" 
                calculator="publicmapping.redistricting.calculators.Schwartzberg"
                description="The competition is using the 'Schwartzberg' compactness measure. This measure is a ratio of the perimeter of the district to the circumference of the circle whose area is equal to the area of the district. ">
            </ScoreFunction>

            <ScoreFunction id="plan_competitiveness" type="plan" label="Competitiveness" 
                calculator="publicmapping.redistricting.calculators.Competitiveness"
                description="Each plan's overall political competitiveness is determined by averaging each district.s 'partisan differential'.  The partisan differential of each district is calculated by subtracting the Democratic 'partisan index' from the Republican 'partisan index'.&lt;br/&gt;&lt;br/&gt;'Heavily' competitive districts are districts with partisan differentials of less than or equal to 5%. 'Generally' competitive districts are districts with partisan differentials of greater than 5% but less than 10%.">
                <SubjectArgument name="democratic" ref="govdem" />
                <SubjectArgument name="republican" ref="govrep" />
            </ScoreFunction>

            <ScoreFunction id="plan_repfairness" type="plan" label="Representational Fairness" 
                calculator="publicmapping.redistricting.calculators.RepresentationalFairness"
                description="Representational fairness is increased when the percentage of districts a party would likely win (based upon the 'partisan index' used to determine Competitiveness) closely mirrors that party.s percentage of the statewide vote. ">
                <SubjectArgument name="democratic" ref="govdem" />
                <SubjectArgument name="republican" ref="govrep" />
                <Argument name="range" value="0.05" />
            </ScoreFunction>

            <!-- For validation -->
            <ScoreFunction id="plan_majority_minority" type="plan" label="Majority Minority" 
                calculator="publicmapping.redistricting.calculators.MajorityMinority"
                description="Compliance with the Voting Rights Act will be assumed if maps include a minority-majority district in any area where a minority group is (as described in Thornburg V. Gingles, 478 U.S> 30, 49 (1986)) 'sufficiently large and geographically compact to constitute a majority in a single-member district'.">
                <SubjectArgument name="minority1" ref="vaphisp" />
                <SubjectArgument name="minority2" ref="vapblk" />
                <SubjectArgument name="population" ref="vap" />
            </ScoreFunction>

            <ScoreFunction id="plan_all_blocks_assigned" type="plan" label="All Blocks Assigned" 
                calculator="publicmapping.redistricting.calculators.AllBlocksAssigned"
                description="All blocks in the plan must be assigned.">
            </ScoreFunction>

            <ScoreFunction id="plan_all_contiguous" type="plan" label="All Contiguous" 
                calculator="publicmapping.redistricting.calculators.AllContiguous"
                description="Contiguity means that every part of a district must be reachable from every other part without crossing the district's borders. All districts within a plan must be contiguous. Water contiguity is permitted given Virginia's extensive coastal region. 'Point contiguity' or 'touch-point contiguity' where two sections of a district are connected at a single point is not permitted.">
            </ScoreFunction>

            <ScoreFunction id="congress_plan_equipopulation" type="plan" label="Equipopulation" 
                calculator="publicmapping.redistricting.calculators.Equipopulation"
                description="The population of each Congressional district must be 727,366 +/- 0.5%.">
                <SubjectArgument name="value" ref="poptot" />
                <Argument name="min" value="723729" />
                <Argument name="max" value="731003" />
            </ScoreFunction>

            <ScoreFunction id="congress_plan_count_districts" type="plan" label="Count Districts" 
                calculator="publicmapping.redistricting.calculators.CountDistricts"
                description="The number of districts in a Congressional redistricting plan must be 11.">
                <Argument name="target" value="11" />
            </ScoreFunction>

            <ScoreFunction id="senate_plan_equipopulation" type="plan" label="Equipopulation" 
                calculator="publicmapping.redistricting.calculators.Equipopulation"
                description="The population of each State Senate district must be 200,026 +/- 5%">
                <SubjectArgument name="value" ref="poptot" />
                <Argument name="min" value="190025" />
                <Argument name="max" value="210027" />
            </ScoreFunction>

            <ScoreFunction id="senate_plan_count_districts" type="plan" label="Count Districts" 
                calculator="publicmapping.redistricting.calculators.CountDistricts"
                description="The number of districts in a State Senate redistricting plan must be 40.">
                <Argument name="target" value="40" />
            </ScoreFunction>

            <ScoreFunction id="house_plan_equipopulation" type="plan" label="Equipopulation" 
                calculator="publicmapping.redistricting.calculators.Equipopulation"
                description="The population of each House of Delegates district must be 80,010 +/- 5%">
                <SubjectArgument name="value" ref="poptot" />
                <Argument name="min" value="76010" />
                <Argument name="max" value="84011" />
            </ScoreFunction>

            <ScoreFunction id="house_plan_count_districts" type="plan" label="Count Districts" 
                calculator="publicmapping.redistricting.calculators.CountDistricts"
                description="The number of districts in a House of Delegates redistricting plan must be 100.">
                <Argument name="target" value="100" />
            </ScoreFunction>
            
        </ScoreFunctions>

        <ScorePanels>
            <!-- 
            Each ScorePanel configuration item describes the settings
            for displaying a set of scores in the user interface. A 
            ScorePanel may be referenced more than once in multiple
            ScoreDisplays.
            -->
            <ScorePanel id="panel_equivalence_all" type="plan" template="leaderboard_panel_all.html"
                title="Equipopulation">
                <Score ref="plan_equivalence"/>
            </ScorePanel>

            <ScorePanel id="panel_schwartzberg_all" type="plan" template="leaderboard_panel_all.html"
                title="Average Compactness" is_ascending="false">
                <Score ref="plan_schwartzberg"/>
            </ScorePanel>

            <ScorePanel id="panel_competitiveness_all" type="plan" template="leaderboard_panel_all.html"
                title="Competitiveness">
                <Score ref="plan_competitiveness"/>
            </ScorePanel>

            <ScorePanel id="panel_repfairness_all" type="plan" template="leaderboard_panel_all.html"
                title="Representational Fairness">
                <Score ref="plan_repfairness"/>
            </ScorePanel>

            <ScorePanel id="panel_equivalence_mine" type="plan" template="leaderboard_panel_mine.html"
                title="Equipopulation">
                <Score ref="plan_equivalence"/>
            </ScorePanel>

            <ScorePanel id="panel_schwartzberg_mine" type="plan" template="leaderboard_panel_mine.html"
                title="Average Compactness" is_ascending="false">
                <Score ref="plan_schwartzberg"/>
            </ScorePanel>

            <ScorePanel id="panel_competitiveness_mine" type="plan" template="leaderboard_panel_mine.html"
                title="Competitiveness">
                <Score ref="plan_competitiveness"/>
            </ScorePanel>

            <ScorePanel id="panel_repfairness_mine" type="plan" template="leaderboard_panel_mine.html"
                title="Representational Fairness">
                <Score ref="plan_repfairness"/>
            </ScorePanel>
        </ScorePanels>

        <ScoreDisplays>
            <ScoreDisplay legislativebodyref="congress" type="leaderboard"
                title="Congressional Leaderboard - All" cssclass="leaderboard congress">
                <ScorePanel ref="panel_equivalence_all" />
                <ScorePanel ref="panel_schwartzberg_all" />
                <ScorePanel ref="panel_competitiveness_all" />
                <ScorePanel ref="panel_repfairness_all" />
            </ScoreDisplay>

            <ScoreDisplay legislativebodyref="house" type="leaderboard"
                title="State House Leaderboard - All" cssclass="leaderboard house">
                <ScorePanel ref="panel_equivalence_all" />
                <ScorePanel ref="panel_schwartzberg_all" />
                <ScorePanel ref="panel_competitiveness_all" />
                <ScorePanel ref="panel_repfairness_all" />
            </ScoreDisplay>

            <ScoreDisplay legislativebodyref="senate" type="leaderboard"
                title="State Senate Leaderboard - All" cssclass="leaderboard senate">
                <ScorePanel ref="panel_equivalence_all" />
                <ScorePanel ref="panel_schwartzberg_all" />
                <ScorePanel ref="panel_competitiveness_all" />
                <ScorePanel ref="panel_repfairness_all" />
            </ScoreDisplay>

            <ScoreDisplay legislativebodyref="congress" type="leaderboard"
                title="Congressional Leaderboard - Mine" cssclass="leaderboard congress">
                <ScorePanel ref="panel_equivalence_mine" />
                <ScorePanel ref="panel_schwartzberg_mine" />
                <ScorePanel ref="panel_competitiveness_mine" />
                <ScorePanel ref="panel_repfairness_mine" />
            </ScoreDisplay>

            <ScoreDisplay legislativebodyref="house" type="leaderboard"
                title="State House Leaderboard - Mine" cssclass="leaderboard house">
                <ScorePanel ref="panel_equivalence_mine" />
                <ScorePanel ref="panel_schwartzberg_mine" />
                <ScorePanel ref="panel_competitiveness_mine" />
                <ScorePanel ref="panel_repfairness_mine" />
            </ScoreDisplay>

            <ScoreDisplay legislativebodyref="senate" type="leaderboard"
                title="State Senate Leaderboard - Mine" cssclass="leaderboard senate">
                <ScorePanel ref="panel_equivalence_mine" />
                <ScorePanel ref="panel_schwartzberg_mine" />
                <ScorePanel ref="panel_competitiveness_mine" />
                <ScorePanel ref="panel_repfairness_mine" />
            </ScoreDisplay>
        </ScoreDisplays>
    </Scoring>

    <!--
    Define the criteria for a 'legal' or 'valid' plan for features such as
    the contest leaderboard.
    -->
    <Validation>
        <!--
        When defining sets of criteria, a single set of criteria is used to
        validate plans agains one legislative body. The philosophy is that
        the plan level scores defined in Scoring/ScoreFunctions above are
        used to evaluate a given plan, and can be used to set thresholds
        or scores for legal plan configurations.

        The description attribute may contain a large amount of text 
        describing the precise criterion used.
        -->
        <Criteria legislativebodyref="congress">
            <Criterion name="CountDistricts - Congress">
                <Score ref="congress_plan_count_districts" />
            </Criterion>
            <Criterion name="Equipopulation - Congress" description="&lt;p&gt;Your plan does not meet the competition criteria for Equipopulation:&lt;/p&gt;&lt;p&gt;The population of each Congressional district must be 727,366 +/- 0.5%.&lt;/p&gt;">
                <Score ref="congress_plan_equipopulation" />
            </Criterion>
            <Criterion name="MajorityMinority - Congress">
                <Score ref="plan_majority_minority" />
            </Criterion>
            <Criterion name="AllBlocksAssigned - Congress">
                <Score ref="plan_all_blocks_assigned" />
            </Criterion>
            <Criterion name="AllContiguous - Congress" description="&lt;p&gt;Your plan does not meet the competition criteria for Contiguity&lt;/p&gt;&lt;p&gt;Every part of a district must be reachable from every other part without crossing the district's borders. All districts within a plan must be contiguous. Water contiguity is permitted given Virginia's extensive coastal region. 'Point contiguity' or 'touch-point contiguity' where two sections of a district are connected at a single point is not permitted.&lt;/p&gt;">
                <Score ref="plan_all_contiguous" />
            </Criterion>
        </Criteria>

        <Criteria legislativebodyref="house">
            <Criterion name="CountDistricts - House">
                <Score ref="house_plan_count_districts" />
            </Criterion>
            <Criterion name="Equipopulation - House" description="&lt;p&gt;Your plan does not meet the competition criteria for Equipopulation:&lt;/p&gt;&lt;p&gt;The population of each House of Delegates district must be 80,010 +/- 0.5%.&lt;/p&gt;">
                <Score ref="house_plan_equipopulation" />
            </Criterion>
            <Criterion name="MajorityMinority - House">
                <Score ref="plan_majority_minority" />
            </Criterion>
            <Criterion name="AllBlocksAssigned - House">
                <Score ref="plan_all_blocks_assigned" />
            </Criterion>
            <Criterion name="AllContiguous - House" description="&lt;p&gt;Your plan does not meet the competition criteria for Contiguity&lt;/p&gt;&lt;p&gt;Every part of a district must be reachable from every other part without crossing the district's borders. All districts within a plan must be contiguous. Water contiguity is permitted given Virginia's extensive coastal region. 'Point contiguity' or 'touch-point contiguity' where two sections of a district are connected at a single point is not permitted.&lt;/p&gt;">
                <Score ref="plan_all_contiguous" />
            </Criterion>
        </Criteria>

        <Criteria legislativebodyref="senate">
            <Criterion name="CountDistricts - Senate">
                <Score ref="senate_plan_count_districts" />
            </Criterion>
            <Criterion name="Equipopulation - Senate" description="&lt;p&gt;Your plan does not meet the competition criteria for Equipopulation:&lt;/p&gt;&lt;p&gt;The population of each State Senate district must be 200,026 +/- 0.5%.&lt;/p&gt;">
                <Score ref="senate_plan_equipopulation" />
            </Criterion>
            <Criterion name="MajorityMinority - Senate">
                <Score ref="plan_majority_minority" />
            </Criterion>
            <Criterion name="AllBlocksAssigned - Senate">
                <Score ref="plan_all_blocks_assigned" />
            </Criterion>
            <Criterion name="AllContiguous - Senate" description="&lt;p&gt;Your plan does not meet the competition criteria for Contiguity&lt;/p&gt;&lt;p&gt;Every part of a district must be reachable from every other part without crossing the district's borders. All districts within a plan must be contiguous. Water contiguity is permitted given Virginia's extensive coastal region. 'Point contiguity' or 'touch-point contiguity' where two sections of a district are connected at a single point is not permitted.&lt;/p&gt;">
                <Score ref="plan_all_contiguous" />
            </Criterion>
        </Criteria>
    </Validation>

    <!--
    Optional configuration for geounits that require special contiguity rules.
    'id' is the portable id of the geounit in which to configure an override.
    'connect_to' is the portable id of the geounit in which the geounit is
    to be considered contiguous with. Tests for contiguity will apply these overrides
    in order to account for contiguity when physical contiguity is not possible.
    For example, an island may need to be marked contiguous with one or more geounits
    on an adjacent coast (possibly containing harbors). 

    <ContiguityOverrides>
        <ContiguityOverride id="510030112012077" connect_to="510030102011065" />
        <ContiguityOverride id="510030112012077" connect_to="510030103003037" />
    </ContiguityOverrides>

    -->

    <GeoLevels>
      <GeoLevel id="block" name="block" min_zoom="9" sort_key="3" tolerance="2.5">
          <!--

          You may use EITHER the "Shapefile" or "Files" element as a child 
          of geolevel to define the geography and attributes. The 
          "Shapefile" element must contain both the geography and 
          attributes, whereas the "Files" element contains an item for the 
          geography, and multiple items for the attributes.
          
          This is in anticipation of loading data that has been downloaded
          directly from the American Fact Finder web application hosted by
          the US Census Beureau.
          
          -->

          <Shapefile path="/projects/publicmapping/data/tl_2010_51_block10_3785_join.shp">
              <Fields>
                  <!-- 

                  Each Field item defines a field in the shapefile that
                  describes a different part of the geographic unit.

                  A "name" type field is used to display the name of the
                  geographic unit.

                  A "portable" type field is used to store the FIPS/GEOID
                  of the geographic unit, which is shared with other GIS
                  systems.

                  A "tree" type field is used to store information about
                  the geography, and where it resides in the tree. This type
                  of field requires a "pos" attribute, which declares which
                  position in the tree the field belongs (starting at 0);
                  a "width" attribute is also required to declare how wide
                  this portion of the tree code is. This is helpful when
                  the treecode may not be zero padded.

                  -->
                  <Field name="NAME10" type="name"/>
                  <Field name="GEOID10" type="portable"/>
                  <Field name="STATEFP10" type="tree" pos="0" width="2"/>
                  <Field name="COUNTYFP10" type="tree" pos="1" width="3"/>
                  <Field name="VTDST10" type="tree" pos="2" width="4"/>
                  <Field name="GEOID10" type="tree" pos="3" width="14"/>
              </Fields>
          </Shapefile>
          
          <!-- 
          
          A reference to the subjects for which attribute data is 
          available at this geolevel.
          
          -->
          <GeoLevelCharacteristics>
              <GeoLevelCharacteristic ref="poptot" />
              <GeoLevelCharacteristic ref="vap" />
              <GeoLevelCharacteristic ref="vapblk" />
              <GeoLevelCharacteristic ref="vaphisp" />
              <GeoLevelCharacteristic ref="govdem" />
              <GeoLevelCharacteristic ref="govrep" />
              <GeoLevelCharacteristic ref="govtot" />
          </GeoLevelCharacteristics>
          
          <!--
          
          A reference to a legislative body. A geolevel may be used by 
          many legislative bodies.
          
          -->
          <LegislativeBodies>
              <LegislativeBody ref="congress">
                  <LegislativeTargets>
                      <LegislativeTarget ref="tottarget" default="true" />
                  </LegislativeTargets>
              </LegislativeBody>
              <LegislativeBody ref="house">
                  <LegislativeTargets>
                      <LegislativeTarget ref="housetarget" default="true" />
                  </LegislativeTargets>
              </LegislativeBody>
              <LegislativeBody ref="senate">
                  <LegislativeTargets>
                      <LegislativeTarget ref="senatetarget" default="true" />
                  </LegislativeTargets>
              </LegislativeBody>
          </LegislativeBodies>
      </GeoLevel>

      <!--
      
      A child geolevel. The geography of the parent geolevel must
      be coincident in its child.
          
      -->
      <GeoLevel id="vtd" name="vtd" min_zoom="5" sort_key="2" tolerance="25">
          <!--

          You may use EITHER the "Shapefile" or "Files" element as a child 
          of geolevel to define the geography and attributes. The 
          "Shapefile" element must contain both the geography and 
          attributes, whereas the "Files" element contains an item for the 
          geography, and multiple items for the attributes.
          
          This is in anticipation of loading data that has been downloaded
          directly from the American Fact Finder web application hosted by
          the US Census Beureau.
          
          -->
          <Files>
              <Geography path="/projects/publicmapping/data/tl_2010_51_vtd10_3785.shp">
                  <!-- 

                  Each Field item defines a field in the shapefile that
                  describes a different part of the geographic unit.

                  A "name" type field is used to display the name of the
                  geographic unit.

                  A "portable" type field is used to store the FIPS/GEOID
                  of the geographic unit, which is shared with other GIS
                  systems.

                  A "tree" type field is used to store information about
                  the geography, and where it resides in the tree. This type
                  of field requires a "pos" attribute, which declares which
                  position in the tree the field belongs (starting at 0);
                  a "width" attribute is also required to declare how wide
                  this portion of the tree code is. This is helpful when
                  the treecode may not be zero padded.

                  -->
                  <Fields>
                      <Field name="NAME10" type="name" />
                      <Field name="GEOID10" type="portable" />
                      <Field name="STATEFP10" type="tree" pos="0" width="2"/>
                      <Field name="COUNTYFP10" type="tree" pos="1" width="3"/>
                      <Field name="VTDST10" type="tree" pos="2" width="4"/>
                  </Fields>
              </Geography>
          </Files>
          
          <!-- 
          
          A reference to the subjects for which attribute data is available
          at this geolevel.
          
          -->
          <GeoLevelCharacteristics>
              <GeoLevelCharacteristic ref="poptot" />
              <GeoLevelCharacteristic ref="vap" />
              <GeoLevelCharacteristic ref="vapblk" />
              <GeoLevelCharacteristic ref="vaphisp" />
              <GeoLevelCharacteristic ref="govdem" />
              <GeoLevelCharacteristic ref="govtot" />
          </GeoLevelCharacteristics>
          
          <!--
          
          A reference to a legislative body. A geolevel may be used by 
          many legislative bodies. 
          
          -->
          <LegislativeBodies>
              <LegislativeBody ref="congress">
                  <Parent ref="block"/>
                  <LegislativeTargets>
                      <LegislativeTarget ref="tottarget" default="true" />
                  </LegislativeTargets>
              </LegislativeBody>
              <LegislativeBody ref="house">
                  <Parent ref="block"/>
                  <LegislativeTargets>
                      <LegislativeTarget ref="housetarget" default="true" />
                  </LegislativeTargets>
              </LegislativeBody>
              <LegislativeBody ref="senate">
                  <Parent ref="block"/>
                  <LegislativeTargets>
                      <LegislativeTarget ref="senatetarget" default="true" />
                  </LegislativeTargets>
              </LegislativeBody>
          </LegislativeBodies>
      </GeoLevel>

      <!--
      
      A child geolevel. The geography of the parent geolevel must
      be coincident in its child.
          
      -->
      <GeoLevel id="county" name="county" min_zoom="0" sort_key="1" tolerance="250">
          <!--

          You may use EITHER the "Shapefile" or "Files" element as a child 
          of geolevel to define the geography and attributes. The 
          "Shapefile" element must contain both the geography and 
          attributes, whereas the "Files" element contains an item for the 
          geography, and multiple items for the attributes.
          
          This is in anticipation of loading data that has been downloaded
          directly from the American Fact Finder web application hosted by
          the US Census Beureau.
          
          -->
          <Files>
              <Geography path="/projects/publicmapping/data/tl_2010_51_county10_3785.shp">
                  <!-- 

                  Each Field item defines a field in the shapefile that
                  describes a different part of the geographic unit.

                  A "name" type field is used to display the name of the
                  geographic unit.

                  A "portable" type field is used to store the FIPS/GEOID
                  of the geographic unit, which is shared with other GIS
                  systems.

                  A "tree" type field is used to store information about
                  the geography, and where it resides in the tree. This type
                  of field requires a "pos" attribute, which declares which
                  position in the tree the field belongs (starting at 0);
                  a "width" attribute is also required to declare how wide
                  this portion of the tree code is. This is helpful when
                  the treecode may not be zero padded.

                  -->
                  <Fields>
                      <Field name="NAME10" type="name"/>
                      <Field name="GEOID10" type="portable"/>
                      <Field name="STATEFP10" type="tree" pos="0" width="2"/>
                      <Field name="COUNTYFP10" type="tree" pos="1" width="3"/>
                  </Fields>
              </Geography>
          </Files>
          
          <!-- 
          
          A reference to the subjects for which attribute data is available
          at this geolevel.
          
          -->
          <GeoLevelCharacteristics>
              <GeoLevelCharacteristic ref="poptot" />
              <GeoLevelCharacteristic ref="vap" />
              <GeoLevelCharacteristic ref="vapblk" />
              <GeoLevelCharacteristic ref="vaphisp" />
              <GeoLevelCharacteristic ref="govdem" />
              <GeoLevelCharacteristic ref="govtot" />
          </GeoLevelCharacteristics>
          
          <!--
          
          A reference to a legislative body. A geolevel may be used by 
          many legislative bodies.
          
          -->
          <LegislativeBodies>
              <LegislativeBody ref="congress">
                  <Parent ref="vtd"/>
                  <LegislativeTargets>
                      <LegislativeTarget ref="tottarget" default="true" />
                  </LegislativeTargets>
              </LegislativeBody>
              <LegislativeBody ref="house">
                  <Parent ref="vtd"/>
                  <LegislativeTargets>
                      <LegislativeTarget ref="housetarget" default="true" />
                  </LegislativeTargets>
              </LegislativeBody>
              <LegislativeBody ref="senate">
                  <Parent ref="vtd"/>
                  <LegislativeTargets>
                      <LegislativeTarget ref="senatetarget" default="true" />
                  </LegislativeTargets>
              </LegislativeBody>
          </LegislativeBodies>
      </GeoLevel>
    </GeoLevels>
   
    <!-- 
    
    This element facilitates the creation of system templates. A
    system template is a plan owned by the admin user, that all other
    users can create derivative plans from.
    
    -->
    <Templates>
        <Template name="Congressional">
            <!-- A reference to a legislative body. -->
            <LegislativeBody ref="congress"/>
            
            <!-- 
            
            The path to the district index file. The index file must be
            a two column CSV file, with each row corresponding to 1) a
            unit of geography, and 2) the district it belongs to.
            
            -->
            <Blockfile path="/projects/publicmapping/data/cd111_index.csv" />
        </Template>
        
        <Template name="State House">
            <LegislativeBody ref="house"/>
            
            <Blockfile path="/projects/publicmapping/data/sldl10_index.csv" />
        </Template>

        <Template name="State Senate">
            <LegislativeBody ref="senate"/>

            <Blockfile path="/projects/publicmapping/data/sldu10_index.csv" />
        </Template>
    </Templates>
    
    <!-- 
    
    Configuration settings for the components of the application. The
    "root" attribute defines the location in the file system, under
    which the rest of the application components can be found.
    
    -->
    <Project root="/projects/publicmapping/trunk" sessionquota="5" 
             sessiontimeout="15">
        <!-- Database connection information. -->
        <Database name="publicmapping" user="publicmapping" password="<enter password>"/>
        
        <!-- 
        
        Administrative user information. This should match the admin
        user created when the django project is created.
        
        -->
        <Admin user="admin" email="admin@..."/>
        
        <!-- Configuration items specific to the 'redistricting' app. -->
        <Redistricting>           
            <!-- 
            
            Information about the mapserver and geoserver settings. 

            The "basemaps" attribute is optional, and can be any set to 
            any combination (CSV) of the following:
              osm-road
              google-road
              google-aerial
              google-hybrid
              bing-road
              bing-aerial
              bing-hybrid
             
            The options are displayed in the order in which they are set,
            with the first one being set to the default base layer. If 
            this is not set, it will default to osm-road. If the desire 
            is to have no base layer, set it to the empty string.
            
            -->
            <MapServer hostname="" ns="gmu" nshref="http://gmu.azavea.com/"
                adminuser="admin" adminpass="geoserver" maxfeatures="100" 
                styles="/projects/publicmapping/trunk/sld" />

            <!-- 
            
            Use a GoogleAnalytics account to tract the usage of the 
            application. This requires an account and domain.

            <GoogleAnalytics account="" domain=""/>
            
            -->

            <!-- Upload file size restrictions. This is in KB -->
            <Upload maxsize="5300"/>

            <!-- Undo restrictions -->
            <MaxUndos duringedit="50" afteredit="10" />

            <!-- Leaderboard configuration -->
            <Leaderboard maxranked="10" />
        </Redistricting>
        
        <!-- 
        
        Configure the engine used for reporting. Currently, BARD is the
        only supported reporting engine.

        -->
        <Reporting>
            <!-- BARD specific configuration settings. -->
            <BardConfigs>
                <!--

                The BARD configuration. 
                
                The "shape" attribute defines where the precomputed BARD
                map is located.

                The "temp" attribute is the location where temporary reports
                should be stored.

                The "transform" attribute is the location of the XSLT 
                transform that generates the HTML content in the reporting
                tab.

                NOTE: it is important that all subjectref attributes of the
                "...Var" elements below match attributes of the original
                block shapefile from which the BARD map is derived.

                -->
                <BardConfig 
                    id="blocks"
                    shape="/projects/publicmapping/data/vablock_bard_save.Rdata" 
                    temp="/projects/publicmapping/local/reports"
                    transform="/projects/publicmapping/trunk/docs/bard_template.xslt">
                    <PopVars>
                        <PopVar subjectref="poptot" threshold=".5" default="true" />
                        <PopVar subjectref="vap" threshold=".1" />
                        <PopVar subjectref="vapwnh" threshold=".1" />
                        <PopVar subjectref="vapblk" threshold=".1" />
                        <PopVar subjectref="vaphisp" threshold=".1" default="false" />
                    </PopVars>
                    <RatioVars>
                        <!--
                        
                        Set up RatioVars for both ethnicity and political 
                        party.
                        
                        -->
                        <RatioVar id="racialComp" label="Majority Minority Districts" threshold=".5">
                            <Numerators>
                                <Numerator subjectref="popblk" />
                                <Numerator subjectref="pophisp" />
                            </Numerators>
                            <Denominator subjectref="poptot" />
                        </RatioVar>
                        <RatioVar id="partyControl" label="Party-Controlled Districts" threshold=".5">
                            <Numerators>
                                <Numerator subjectref="presdem" />
                                <Numerator subjectref="presrep" />
                            </Numerators>
                            <Denominator subjectref="vap" />
                        </RatioVar>
                    </RatioVars>
                    <SplitVars>
                        <!-- 
                        
                        See whether a given district splits a geography.
                        This can be any higher level geography: a county,
                        VTd, or tract.

                        -->
                        <SplitVar field="COUNTYST10" label="County" />
                        <SplitVar field="VTDST10" label="VTD" />
                        <SplitVar field="TRACTCE10" label="Tract" />
                    </SplitVars>
                </BardConfig>
            </BardConfigs>
            <BardBodyConfigs>
                <!--

                For each legislative body, map the configuration to the
                geography used to generate reports.

                -->
                <BardBodyConfig
                    id="congress_blocks"
                    legislativebodyref="congress"
                    bardconfigref="blocks" />
                <BardBodyConfig
                    id="house_blocks"
                    legislativebodyref="house"
                    bardconfigref="blocks" />
                <BardBodyConfig
                    id="senate_blocks"
                    legislativebodyref="senate"
                    bardconfigref="blocks" />
            </BardBodyConfigs>
        </Reporting>
        
        <!-- Information about the mailer configuration. -->
        <Mailer server="localhost" port="25" username="" password=""/>
    </Project>
    
</DistrictBuilder>
